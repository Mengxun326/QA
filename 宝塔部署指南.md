# Q&Aé—®ç­”å¹³å° - å®å¡”é¢æ¿éƒ¨ç½²æŒ‡å—

## ğŸ“‹ éƒ¨ç½²å‰å‡†å¤‡

### 1. æœåŠ¡å™¨è¦æ±‚
- **æ“ä½œç³»ç»Ÿ**: CentOS 7+ / Ubuntu 18+ / Debian 9+
- **å†…å­˜**: è‡³å°‘ 1GB RAM
- **ç¡¬ç›˜**: è‡³å°‘ 10GB å¯ç”¨ç©ºé—´
- **ç½‘ç»œ**: ç¡®ä¿æœåŠ¡å™¨å¯ä»¥è®¿é—®å¤–ç½‘

### 2. å®å¡”é¢æ¿è¦æ±‚
- **å®å¡”Linuxé¢æ¿**: 7.0+ ç‰ˆæœ¬
- **å¿…éœ€è½¯ä»¶**: Nginx, MySQL 5.7+, PM2ç®¡ç†å™¨
- **Node.js**: 16+ ç‰ˆæœ¬

## ğŸš€ éƒ¨ç½²æ­¥éª¤

### ç¬¬ä¸€æ­¥ï¼šå®‰è£…å®å¡”é¢æ¿ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰

```bash
# CentOS/RHEL
yum install -y wget && wget -O install.sh http://download.bt.cn/install/install_6.0.sh && sh install.sh

# Ubuntu/Debian
wget -O install.sh http://download.bt.cn/install/install-ubuntu_6.0.sh && sudo bash install.sh
```

### ç¬¬äºŒæ­¥ï¼šå®‰è£…å¿…éœ€è½¯ä»¶

1. **ç™»å½•å®å¡”é¢æ¿**
   - è®¿é—® `http://ä½ çš„æœåŠ¡å™¨IP:8888`
   - ä½¿ç”¨å®‰è£…æ—¶æ˜¾ç¤ºçš„ç”¨æˆ·åå’Œå¯†ç ç™»å½•

2. **å®‰è£…è½¯ä»¶æ ˆ**
   - è¿›å…¥"è½¯ä»¶å•†åº—"
   - å®‰è£…ä»¥ä¸‹è½¯ä»¶ï¼š
     - **Nginx** (æ¨èæœ€æ–°ç‰ˆæœ¬)
     - **MySQL** (5.7 æˆ– 8.0)
     - **PM2ç®¡ç†å™¨** (Node.jsåº”ç”¨ç®¡ç†)
     - **Node.jsç‰ˆæœ¬ç®¡ç†å™¨** (å®‰è£…Node.js 16+)

### ç¬¬ä¸‰æ­¥ï¼šä¸Šä¼ é¡¹ç›®æ–‡ä»¶

1. **åˆ›å»ºç½‘ç«™ç›®å½•**
   ```bash
   mkdir -p /www/wwwroot/qa-platform
   ```

2. **ä¸Šä¼ é¡¹ç›®æ–‡ä»¶**
   - æ–¹å¼ä¸€ï¼šä½¿ç”¨å®å¡”é¢æ¿æ–‡ä»¶ç®¡ç†å™¨ä¸Šä¼ 
   - æ–¹å¼äºŒï¼šä½¿ç”¨Gitå…‹éš†ï¼ˆæ¨èï¼‰
   ```bash
   cd /www/wwwroot
   git clone [ä½ çš„é¡¹ç›®ä»“åº“åœ°å€] qa-platform
   ```

3. **è®¾ç½®ç›®å½•æƒé™**
   ```bash
   chown -R www:www /www/wwwroot/qa-platform
   chmod -R 755 /www/wwwroot/qa-platform
   ```

### ç¬¬å››æ­¥ï¼šé…ç½®æ•°æ®åº“

1. **åˆ›å»ºæ•°æ®åº“**
   - è¿›å…¥å®å¡”é¢æ¿ â†’ æ•°æ®åº“ â†’ æ·»åŠ æ•°æ®åº“
   - æ•°æ®åº“åï¼š`qa_platform`
   - ç”¨æˆ·åï¼š`qa_user`ï¼ˆå»ºè®®ï¼‰
   - å¯†ç ï¼šè®¾ç½®ä¸€ä¸ªå¼ºå¯†ç 

2. **å¯¼å…¥æ•°æ®åº“ç»“æ„**
   - åœ¨æ•°æ®åº“ç®¡ç†ä¸­ï¼Œç‚¹å‡»"å¯¼å…¥"
   - ä¸Šä¼ é¡¹ç›®ä¸­çš„ `database.sql` æ–‡ä»¶
   - æˆ–è€…ä½¿ç”¨phpMyAdminå¯¼å…¥

### ç¬¬äº”æ­¥ï¼šé…ç½®åç«¯æœåŠ¡

1. **è¿›å…¥æœåŠ¡å™¨ç›®å½•**
   ```bash
   cd /www/wwwroot/qa-platform/server
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **é…ç½®ç¯å¢ƒå˜é‡**
   ```bash
   cp config.env.example config.env
   ```
   
   ç¼–è¾‘ `config.env` æ–‡ä»¶ï¼š
   ```env
   # æ•°æ®åº“é…ç½®
   DB_HOST=localhost
   DB_USER=qa_user
   DB_PASSWORD=ä½ çš„æ•°æ®åº“å¯†ç 
   DB_NAME=qa_platform
   
   # JWTå¯†é’¥ï¼ˆè¯·è®¾ç½®ä¸€ä¸ªå¤æ‚çš„å¯†é’¥ï¼‰
   JWT_SECRET=your_super_secret_jwt_key_here_make_it_long_and_complex
   
   # æœåŠ¡å™¨ç«¯å£
   PORT=5000
   
   # ç®¡ç†å‘˜é»˜è®¤è´¦å·
   ADMIN_USERNAME=admin
   ADMIN_PASSWORD=admin123
   ```

4. **åˆ›å»ºç®¡ç†å‘˜è´¦æˆ·**
   ```bash
   npm run create-admin
   ```

### ç¬¬å…­æ­¥ï¼šé…ç½®å‰ç«¯

1. **è¿›å…¥å‰ç«¯ç›®å½•**
   ```bash
   cd /www/wwwroot/qa-platform/client
   ```

2. **å®‰è£…ä¾èµ–**
   ```bash
   npm install
   ```

3. **ä¿®æ”¹APIåœ°å€**
   ç¼–è¾‘ `src/services/api.js`ï¼Œå°†APIåŸºç¡€URLæ”¹ä¸ºä½ çš„æœåŠ¡å™¨åœ°å€ï¼š
   ```javascript
   const API_BASE_URL = 'http://ä½ çš„åŸŸåæˆ–IP:5000/api';
   // æˆ–è€…å¦‚æœä½¿ç”¨åå‘ä»£ç†ï¼š
   const API_BASE_URL = '/api';
   ```

4. **æ„å»ºç”Ÿäº§ç‰ˆæœ¬**
   ```bash
   npm run build
   ```

### ç¬¬ä¸ƒæ­¥ï¼šé…ç½®PM2ç®¡ç†Node.jsåº”ç”¨

1. **å®‰è£…PM2ï¼ˆå¦‚æœè¿˜æ²¡å®‰è£…ï¼‰**
   ```bash
   npm install -g pm2
   ```

2. **åˆ›å»ºPM2é…ç½®æ–‡ä»¶**
   åœ¨é¡¹ç›®æ ¹ç›®å½•åˆ›å»º `ecosystem.config.js`ï¼š
   ```javascript
   module.exports = {
     apps: [{
       name: 'qa-platform-server',
       script: './server/index.js',
       cwd: '/www/wwwroot/qa-platform',
       instances: 1,
       autorestart: true,
       watch: false,
       max_memory_restart: '1G',
       env: {
         NODE_ENV: 'production',
         PORT: 5000
       }
     }]
   };
   ```

3. **å¯åŠ¨åº”ç”¨**
   ```bash
   cd /www/wwwroot/qa-platform
   pm2 start ecosystem.config.js
   pm2 save
   pm2 startup
   ```

### ç¬¬å…«æ­¥ï¼šé…ç½®Nginx

1. **åœ¨å®å¡”é¢æ¿ä¸­æ·»åŠ ç½‘ç«™**
   - ç½‘ç«™ â†’ æ·»åŠ ç«™ç‚¹
   - åŸŸåï¼šä½ çš„åŸŸåï¼ˆå¦‚ï¼šqa.example.comï¼‰
   - æ ¹ç›®å½•ï¼š`/www/wwwroot/qa-platform/client/build`

2. **é…ç½®Nginxåå‘ä»£ç†**
   ç‚¹å‡»ç½‘ç«™è®¾ç½® â†’ é…ç½®æ–‡ä»¶ï¼Œæ·»åŠ ä»¥ä¸‹é…ç½®ï¼š
   ```nginx
   server {
       listen 80;
       server_name ä½ çš„åŸŸå;
       root /www/wwwroot/qa-platform/client/build;
       index index.html;
       
       # å‰ç«¯é™æ€æ–‡ä»¶
       location / {
           try_files $uri $uri/ /index.html;
       }
       
       # APIåå‘ä»£ç†
       location /api {
           proxy_pass http://127.0.0.1:5000;
           proxy_set_header Host $host;
           proxy_set_header X-Real-IP $remote_addr;
           proxy_set_header X-Forwarded-For $proxy_add_x_forwarded_for;
           proxy_set_header X-Forwarded-Proto $scheme;
       }
       
       # é™æ€èµ„æºç¼“å­˜
       location ~* \.(js|css|png|jpg|jpeg|gif|ico|svg)$ {
           expires 1y;
           add_header Cache-Control "public, immutable";
       }
   }
   ```

### ç¬¬ä¹æ­¥ï¼šé…ç½®SSLè¯ä¹¦ï¼ˆæ¨èï¼‰

1. **ç”³è¯·SSLè¯ä¹¦**
   - åœ¨å®å¡”é¢æ¿ä¸­ï¼šç½‘ç«™ â†’ SSL â†’ Let's Encrypt
   - æˆ–ä¸Šä¼ è‡ªå·±çš„SSLè¯ä¹¦

2. **å¼ºåˆ¶HTTPS**
   - å¼€å¯"å¼ºåˆ¶HTTPS"é€‰é¡¹

### ç¬¬åæ­¥ï¼šè®¾ç½®é˜²ç«å¢™å’Œå®‰å…¨

1. **é…ç½®é˜²ç«å¢™**
   - å®‰å…¨ â†’ é˜²ç«å¢™
   - å¼€æ”¾ç«¯å£ï¼š80, 443, 8888ï¼ˆå®å¡”é¢æ¿ï¼‰
   - å…³é—­ä¸å¿…è¦çš„ç«¯å£

2. **é…ç½®å®‰å…¨è®¾ç½®**
   - ä¿®æ”¹å®å¡”é¢æ¿é»˜è®¤ç«¯å£
   - è®¾ç½®å¤æ‚çš„é¢æ¿å¯†ç 
   - å¼€å¯é¢æ¿SSL

## ğŸ”§ éƒ¨ç½²åé…ç½®

### 1. æµ‹è¯•åº”ç”¨
- è®¿é—®ä½ çš„åŸŸåï¼Œç¡®ä¿å‰ç«¯æ­£å¸¸åŠ è½½
- æµ‹è¯•ç™»å½•åŠŸèƒ½ï¼ˆä½¿ç”¨åˆ›å»ºçš„ç®¡ç†å‘˜è´¦æˆ·ï¼‰
- æµ‹è¯•æé—®å’Œå›ç­”åŠŸèƒ½

### 2. ç›‘æ§å’Œç»´æŠ¤
```bash
# æŸ¥çœ‹PM2åº”ç”¨çŠ¶æ€
pm2 status

# æŸ¥çœ‹åº”ç”¨æ—¥å¿—
pm2 logs qa-platform-server

# é‡å¯åº”ç”¨
pm2 restart qa-platform-server

# æŸ¥çœ‹åº”ç”¨ç›‘æ§
pm2 monit
```

### 3. æ•°æ®åº“å¤‡ä»½
- åœ¨å®å¡”é¢æ¿ä¸­è®¾ç½®å®šæ—¶å¤‡ä»½
- å»ºè®®æ¯å¤©è‡ªåŠ¨å¤‡ä»½æ•°æ®åº“

## ğŸ› å¸¸è§é—®é¢˜è§£å†³

### 1. Node.jsç‰ˆæœ¬é—®é¢˜
```bash
# ä½¿ç”¨nvmç®¡ç†Node.jsç‰ˆæœ¬
curl -o- https://raw.githubusercontent.com/nvm-sh/nvm/v0.39.0/install.sh | bash
nvm install 16
nvm use 16
```

### 2. æƒé™é—®é¢˜
```bash
# ä¿®å¤æƒé™
chown -R www:www /www/wwwroot/qa-platform
chmod -R 755 /www/wwwroot/qa-platform
```

### 3. ç«¯å£è¢«å ç”¨
```bash
# æŸ¥çœ‹ç«¯å£å ç”¨
netstat -tulpn | grep :5000
# æˆ–
lsof -i :5000
```

### 4. PM2åº”ç”¨æ— æ³•å¯åŠ¨
```bash
# æŸ¥çœ‹è¯¦ç»†é”™è¯¯æ—¥å¿—
pm2 logs qa-platform-server --lines 100
```

## ğŸ“± ç§»åŠ¨ç«¯é€‚é…

é¡¹ç›®å·²ç»åŒ…å«å“åº”å¼è®¾è®¡ï¼Œè‡ªåŠ¨é€‚é…ç§»åŠ¨è®¾å¤‡ã€‚

## ğŸ”„ æ›´æ–°éƒ¨ç½²

å½“éœ€è¦æ›´æ–°ä»£ç æ—¶ï¼š
```bash
cd /www/wwwroot/qa-platform
git pull origin main
cd client && npm run build
pm2 restart qa-platform-server
```

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœåœ¨éƒ¨ç½²è¿‡ç¨‹ä¸­é‡åˆ°é—®é¢˜ï¼Œè¯·æ£€æŸ¥ï¼š
1. æœåŠ¡å™¨æ—¥å¿—ï¼š`/www/wwwroot/qa-platform/server/logs/`
2. Nginxé”™è¯¯æ—¥å¿—ï¼š`/www/wwwroot/qa-platform/logs/`
3. PM2åº”ç”¨æ—¥å¿—ï¼š`pm2 logs`

---

**ç¥æ‚¨éƒ¨ç½²æˆåŠŸï¼** ğŸ‰ 